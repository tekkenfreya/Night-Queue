# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

NightQueue - A web application for movie tracking and discovery platform with search, personal watchlist management, and enhanced features.

## Technology Stack
- **Framework**: Next.js (React with TypeScript)
- **Language**: TypeScript
- **State Management**: Redux Toolkit
- **Styling**: CSS Modules / Tailwind CSS
- **Database**: PostgreSQL for user data and watchlists
- **External APIs**: TMDb API for movie data, OMDb API for additional metadata
- **Theme**: Netflix red (#E50914) and dark (#141414) color scheme
- **Authentication**: NextAuth.js or simple JWT implementation
- **Deployment**: Vercel (recommended for Next.js)

## Core Features
1. **Movie Search & Discovery**: Search by title, genre, year, director with filtering and sorting
2. **Personal Watchlist Management**: 
   - Add movies to "Want to Watch" list
   - Mark movies as "Watched" with personal ratings (1-5 stars)
   - Notes section for personal thoughts and where you watched it
3. **Enhanced Features**: Random movie picker, streaming availability, recommendations

## Critical Development Rules

### Conditional Rendering Rule (MANDATORY)
**ALWAYS use safe conditional rendering patterns to prevent rendering errors.**

❌ **WRONG - Can cause unexpected rendering:**
```jsx
{movie.rating && movie.rating > 0 && (
  <div>Rating: {movie.rating}/5</div>
)}
```

✅ **CORRECT - Use ternary operator or null:**
```jsx
{movie.rating && movie.rating > 0 ? (
  <div>Rating: {movie.rating}/5</div>
) : null}
```

**Why:** When `rating` is `0`, the logical AND renders `0` as unwanted content.

**Always use:**
- Ternary operators: `condition ? <Component /> : null`
- Explicit null checks: `value != null && <Component />`
- Boolean conversion for safe checks: `!!value && <Component />`

### Property Name Verification Rule (MANDATORY)
**ALWAYS verify property names match between interfaces when integrating data between different parts of the codebase.**

**Before writing integration code, check:**
1. **TypeScript interfaces** for expected property names
2. **API service interfaces** for parameter names  
3. **Database schema** for actual column names
4. **Form data structure** for UI form field names

❌ **COMMON MISTAKES:**
```tsx
// Service expects 'releaseDate', interface expects 'year'
await service.searchMovies({ releaseDate: 2023 }); // ERROR

// Form uses string, interface expects number
rating: "4" // vs rating: 4
```

✅ **CORRECT APPROACH:**
```tsx
// 1. Check the Movie interface first
interface Movie {
  id: number;
  title: string;
  year: number;           // NOT releaseDate
  rating: number;         // NOT string
  genres: string[];       // NOT genre (singular)
}

// 2. Map form data to match interface
await service.searchMovies({
  year: parseInt(formData.year),     // Map correctly
  rating: parseInt(formData.rating), // Convert to number
  genres: formData.genres.split(',') // Convert to array
});
```

**Why:** Property name mismatches cause TypeScript errors and runtime failures. Different parts of the codebase (forms, services, interfaces, database) may use different naming conventions.

## Tasks

1. First think through the problem, read the codebase for relevant files, and write a plan to tasks/todo.md.
2. The plan should have a list of todo items that you can check off as you complete them
3. Before you begin working, check in with me and I will verify the plan.
4. Then, begin working on the todo items, marking them as complete as you go.
5. Please every step of the way just give me a high level explanation of what changes you made
6. Make every task and code change you do as simple as possible. We want to avoid making any massive or complex changes. Every change should impact as little code as possible. Everything is about simplicity.
7. When making commit with github, do not ever write generated by claude AI or any AI.
8. Always use Claude Sonnet 4 as model not GPT.
9. **ALWAYS check all variable names, imports, and dependencies before adding or modifying code. Verify that all referenced components, functions, and types exist and are properly imported. This prevents build errors and missing dependencies.**